(this.webpackJsonpsimplemessengerapp=this.webpackJsonpsimplemessengerapp||[]).push([[0],{26:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),s=n(16),a=n.n(s),r=(n(26),n.p,n(9),n(2)),i=function(){return window.location.protocol+"//"+window.location.host+"/api"},l=n(40),u=n(1);var j=function(e){var t=Object(c.useState)([]),n=Object(r.a)(t,2),o=n[0],s=n[1],a=Object(c.useState)(!0),j=Object(r.a)(a,2),b=j[0],d=j[1];return Object(c.useEffect)((function(){var t=setInterval((function(){fetch("".concat(i(),"/message/?receiver=").concat(e.otherUser),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken}}).then((function(e){return e.json()})).then((function(e){s(e),d(!1)}))}),1e3);return function(){return clearInterval(t)}}),[e.otherUser,e.userName]),Object(u.jsx)("div",{children:b?Object(u.jsx)(l.a,{}):Object(u.jsx)("div",{className:"Messages-box",children:o.map((function(t){return function(t){var n=new Date(t.time);return t.sender===e.userName?Object(u.jsxs)("div",{className:"Message-element",children:[t.message," ",Object(u.jsx)("span",{className:"Message-time",children:n.toLocaleString()})]}):Object(u.jsxs)("div",{className:"Received-Message-element",children:[t.message," ",Object(u.jsx)("span",{className:"Message-time",children:n.toLocaleString()})]})}(t)}))})})},b=n(11),d=n(12),h=n.n(d),g=n(20),O=function(e){var t=Object(c.useState)([]),n=Object(r.a)(t,2),o=n[0],s=n[1];Object(c.useEffect)((function(){var t=setInterval((function(){fetch("".concat(i(),"/user/otherUsers/"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken}}).then((function(e){return e.json()})).then((function(t){0!==t.length&&0==o.length&&(e.getBackSelectedUser(t[0].username),e.getBackIsOtherUserSelected(!0)),s(t)}))}),2e3);return function(){clearInterval(t)}}),[]);return Object(u.jsx)("div",{children:Object(u.jsx)("select",{id:"users",name:"users",onChange:function(t){e.getBackSelectedUser(t.target.value),e.getBackIsOtherUserSelected(!0)},children:o.map((function(e){return Object(u.jsx)("option",{children:e.username})}))})})},p="1006529598178-qes2svv7q1t0a6pfgq01gq1te9fosee6.apps.googleusercontent.com";var f=function(e){var t=Object(c.useState)(""),n=Object(r.a)(t,2),o=n[0],s=n[1],a=Object(c.useState)(""),l=Object(r.a)(a,2),d=l[0],f=l[1],m=Object(c.useState)(""),x=Object(r.a)(m,2),v=x[0],S=x[1],T=Object(c.useState)(!1),k=Object(r.a)(T,2),y=k[0],L=k[1],I=Object(c.useState)([]),w=Object(r.a)(I,2),B=(w[0],w[1]),U=Object(c.useState)(!1),A=Object(r.a)(U,2),N=A[0],C=A[1];return Object(u.jsxs)("div",{children:[y?Object(u.jsxs)("div",{children:[Object(u.jsx)(b.GoogleLogout,{clientId:p,buttonText:"Logout",onLogoutSuccess:function(){s(""),f(""),S(""),B([]),L(!1),C(!1),console.log("Logout made successfully"),alert("Logout made successfully \u270c")}}),Object(u.jsxs)("b",{children:[" Logged in as : ",v," "]}),Object(u.jsx)("br",{})," ",Object(u.jsx)("br",{}),Object(u.jsx)(O,{getBackSelectedUser:s,getBackIsOtherUserSelected:C}),Object(u.jsx)("br",{})," ",Object(u.jsx)("br",{})]}):Object(u.jsxs)("div",{children:[Object(u.jsx)(b.GoogleLogin,{clientId:p,buttonText:"Login",onSuccess:function(e){console.log("Login Success: currentUser:",e.profileObj),alert("Logged in successfully welcome ".concat(e.profileObj.name," \ud83d\ude0d. \n See console for full profile object.")),function(e){var t=1e3*(e.tokenObj.expires_in||3300);localStorage.setItem("authToken",e.tokenObj.id_token);var n=function(){var c=Object(g.a)(h.a.mark((function c(){var o;return h.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,e.reloadAuthResponse();case 2:o=c.sent,t=1e3*(o.expires_in||3300),localStorage.setItem("authToken",o.id_token),setTimeout(n,t);case 6:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}();setTimeout(n,t)}(e),S(e.profileObj.email),L(!0),fetch("".concat(i(),"/user/"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken}})},onFailure:function(e){console.log("Login failed: res:",e),alert("Failed to login. \ud83d\ude22 ")},cookiePolicy:"single_host_origin",style:{marginTop:"100px"},isSignedIn:!0}),Object(u.jsx)("b",{children:" Please login with you email id to get started"})]}),N?Object(u.jsxs)("div",{children:[Object(u.jsx)(j,{userName:v,otherUser:o}),Object(u.jsxs)("form",{onSubmit:function(e){e.preventDefault(),0!==d.length&&fetch("".concat(i(),"/message/"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({receiver:o,message:d})}).then((function(){f("")}))},children:[Object(u.jsx)("label",{htmlFor:"new-todo",children:"Enter your message here..."}),Object(u.jsx)("input",{id:"new-todo",onChange:function(e){f(e.target.value)},value:d}),Object(u.jsx)("button",{children:"Send"})]})]}):Object(u.jsx)("div",{})]})};var m=function(){return Object(u.jsx)("div",{className:"App",children:Object(u.jsx)(f,{})})},x=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,41)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),c(e),o(e),s(e),a(e)}))};a.a.render(Object(u.jsx)(o.a.StrictMode,{children:Object(u.jsx)(m,{})}),document.getElementById("root")),x()},9:function(e,t,n){}},[[33,1,2]]]);
//# sourceMappingURL=main.45d4adef.chunk.js.map