(this.webpackJsonpsimplemessengerapp=this.webpackJsonpsimplemessengerapp||[]).push([[0],{26:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var o=n(0),c=n.n(o),s=n(16),a=n.n(s),r=(n(26),n.p,n(9),n(3)),i=function(){return window.location.protocol+"//"+window.location.host+"/api"},l=n(40),u=n(1);var j=function(e){var t=Object(o.useState)([]),n=Object(r.a)(t,2),c=n[0],s=n[1],a=Object(o.useState)(!0),j=Object(r.a)(a,2),b=j[0],d=j[1];return Object(o.useEffect)((function(){var t=setInterval((function(){fetch("".concat(i(),"/message/?receiver=").concat(e.otherUser),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken}}).then((function(e){return e.json()})).then((function(e){s(e),d(!1)}))}),1e3);return function(){return clearInterval(t)}}),[e.otherUser,e.userName]),Object(u.jsx)("div",{children:b?Object(u.jsx)(l.a,{}):Object(u.jsx)("div",{className:"Messages-box",children:c.map((function(t){return function(t){var n=new Date(t.time);return t.sender===e.userName?Object(u.jsxs)("div",{className:"Message-element",children:[t.message," ",Object(u.jsx)("span",{className:"Message-time",children:n.toLocaleString()})]}):Object(u.jsxs)("div",{className:"Received-Message-element",children:[t.message," ",Object(u.jsx)("span",{className:"Message-time",children:n.toLocaleString()})]})}(t)}))})})},b=n(11),d=n(12),h=n.n(d),g=n(20),p="1006529598178-qes2svv7q1t0a6pfgq01gq1te9fosee6.apps.googleusercontent.com";var O=function(e){var t=Object(o.useState)(""),n=Object(r.a)(t,2),c=n[0],s=n[1],a=Object(o.useState)(""),l=Object(r.a)(a,2),d=l[0],O=l[1],f=Object(o.useState)(""),m=Object(r.a)(f,2),x=m[0],v=m[1],S=Object(o.useState)(!1),T=Object(r.a)(S,2),y=T[0],L=T[1],k=Object(o.useState)([]),w=Object(r.a)(k,2),A=w[0],N=w[1],C=Object(o.useState)(!1),I=Object(r.a)(C,2),E=I[0],F=I[1];return Object(u.jsxs)("div",{children:[y?Object(u.jsxs)("div",{children:[Object(u.jsx)(b.GoogleLogout,{clientId:p,buttonText:"Logout",onLogoutSuccess:function(){s(""),O(""),v(""),N([]),L(!1),F(!1),console.log("Logout made successfully"),alert("Logout made successfully \u270c")}}),Object(u.jsxs)("b",{children:[" Logged in as : ",x," "]}),Object(u.jsx)("br",{})," ",Object(u.jsx)("br",{}),Object(u.jsx)("select",{id:"users",name:"users",onChange:function(e){console.log(e),s(e.target.value),F(!0)},children:A.map((function(e){return Object(u.jsx)("option",{children:e.username})}))}),Object(u.jsx)("br",{})," ",Object(u.jsx)("br",{})]}):Object(u.jsxs)("div",{children:[Object(u.jsx)(b.GoogleLogin,{clientId:p,buttonText:"Login",onSuccess:function(e){console.log("Login Success: currentUser:",e.profileObj),alert("Logged in successfully welcome ".concat(e.profileObj.name," \ud83d\ude0d. \n See console for full profile object.")),function(e){var t=1e3*(e.tokenObj.expires_in||3300);localStorage.setItem("authToken",e.tokenObj.id_token);var n=function(){var o=Object(g.a)(h.a.mark((function o(){var c;return h.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.reloadAuthResponse();case 2:c=o.sent,t=1e3*(c.expires_in||3300),localStorage.setItem("authToken",c.id_token),setTimeout(n,t);case 6:case"end":return o.stop()}}),o)})));return function(){return o.apply(this,arguments)}}();setTimeout(n,t)}(e),v(e.profileObj.email),L(!0),fetch("".concat(i(),"/user/"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken}}),fetch("".concat(i(),"/user/otherUsers/"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken}}).then((function(e){return e.json()})).then((function(e){N(e),s(e[0].username),void 0!=e[0].username&&F(!0)}))},onFailure:function(e){console.log("Login failed: res:",e),alert("Failed to login. \ud83d\ude22 ")},cookiePolicy:"single_host_origin",style:{marginTop:"100px"},isSignedIn:!0}),Object(u.jsx)("b",{children:" Please login with you email id to get started"})]}),E?Object(u.jsxs)("div",{children:[Object(u.jsx)(j,{userName:x,otherUser:c}),Object(u.jsxs)("form",{onSubmit:function(e){e.preventDefault(),0!==d.length&&fetch("".concat(i(),"/message/"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.authToken},body:JSON.stringify({receiver:c,message:d})}).then((function(){console.log("MESSAGE SENT"),O("")}))},children:[Object(u.jsx)("label",{htmlFor:"new-todo",children:"Enter your message here..."}),Object(u.jsx)("input",{id:"new-todo",onChange:function(e){O(e.target.value)},value:d}),Object(u.jsx)("button",{children:"Send"})]})]}):Object(u.jsx)("div",{})]})};var f=function(){return Object(u.jsx)("div",{className:"App",children:Object(u.jsx)(O,{})})},m=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,41)).then((function(t){var n=t.getCLS,o=t.getFID,c=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),o(e),c(e),s(e),a(e)}))};a.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(f,{})}),document.getElementById("root")),m()},9:function(e,t,n){}},[[33,1,2]]]);
//# sourceMappingURL=main.7d11682a.chunk.js.map